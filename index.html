<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
	<head>
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script type="text/javascript">
		google.load("visualization", "1", {
			packages: ["corechart", "annotatedtimeline"]
		});
		google.load("jquery", "1");

		function OnLoad() {
			var url = 'http://91.121.117.128:27080/sensors/consolidatedData_OneMinute/_find?sort=%7B"_id":-1%7D&criteria=%7B"_id.sensorId"%3A"CUBE_TEMPERATURE"%7D&batch_size=60&callback=?';
			$.getJSON(url,
				function(data) {
					if (data.results &&
						data.results.length > 0) {
							var rows = data.results;
							var data = new google.visualization.DataTable();
							data.addColumn('datetime', 'Time');
							data.addColumn('number', 'Cube temperature');
							data.addRows(rows.length);

							for (var i = 0; i < rows.length; i++) {
								data.setValue(rows.length - i - 1, 0, new Date(rows[i]._id.ts["$date"]));
								data.setValue(rows.length - i - 1, 1, rows[i].value.minimum);
							}

							var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
							chart.draw(data, {
								width: 900,
								height: 500,
								title: 'Cube sensors'
							});
						}
					});
				}
				google.setOnLoadCallback(OnLoad);
		</script>
		<title></title>
	</head>
	<body>
		<div id='chart_div' style='width: 900px; height: 500px;'></div>
		<div id="content"></div>
	</body>
</html>
